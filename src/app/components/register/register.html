<div class="page">
  <main class="main">
    <div class="card">
      <div class="card-header">
        <h1>Join KnowledgeHub</h1>
        <p>Create your account and start your learning journey today</p>
      </div>

      <mat-horizontal-stepper [linear]="isLinear" #stepper>
        <!-- STEP 1 -->
        <mat-step [stepControl]="FirstFg">
          <form [formGroup]="FirstFg">
            <ng-template matStepLabel>Personal Information</ng-template>

            <mat-form-field appearance="fill">
              <mat-label>User Name</mat-label>
              <input matInput formControlName="userNameCtrl" placeholder="UserName" required />
            </mat-form-field>

            <mat-form-field appearance="fill">
              <mat-label>Email</mat-label>
              <input matInput formControlName="emailCtrl" placeholder="Email" required />
            </mat-form-field>

            <mat-form-field appearance="fill">
              <mat-label>Password</mat-label>
              <input matInput type="password" formControlName="passwordCtrl" required />
            </mat-form-field>

            <mat-form-field appearance="fill">
              <mat-label>Confirm Password</mat-label>
              <input matInput type="password" formControlName="confirmPasswordCtrl" required />
            </mat-form-field>

            <div>
              <button mat-flat-button color="primary" matStepperNext [disabled]="FirstFg.invalid">
                Next
              </button>
            </div>
          </form>
        </mat-step>

        <!-- STEP 2 -->
        <mat-step [stepControl]="SecondFg">
          <form [formGroup]="SecondFg">
            <ng-template matStepLabel>Extra Information</ng-template>

            <!-- Age -->
            <mat-form-field appearance="fill">
              <mat-label>Age</mat-label>
              <input matInput type="number" formControlName="ageCtrl" placeholder="1â€“99" required />
            </mat-form-field>

            <!-- Gender -->
            <mat-form-field appearance="fill">
              <mat-label>Gender</mat-label>
              <input
                type="text"
                matInput
                placeholder="Select Gender"
                [formControl]="GenderCtrl"
                [matAutocomplete]="autoGender"
              />
              <mat-autocomplete #autoGender="matAutocomplete">
                @for (option of filteredOptions | async; track option) {
                  <mat-option [value]="option">{{ option }}</mat-option>
                }
              </mat-autocomplete>
            </mat-form-field>

            <!-- Country -->
            <mat-form-field appearance="fill">
              <mat-label>Country</mat-label>
              <mat-select formControlName="countryCtrl" (selectionChange)="onCountryChange($event)">
                @for (country of countries; track country.isoCode) {
                  <mat-option [value]="country.isoCode">{{ country.name }}</mat-option>
                }
              </mat-select>
            </mat-form-field>

            <!-- State -->
            <mat-form-field appearance="fill">
              <mat-label>State</mat-label>
              <mat-select formControlName="stateCtrl" (selectionChange)="onStateChange($event)">
                @for (state of states; track state.isoCode) {
                  <mat-option [value]="state.isoCode">{{ state.name }}</mat-option>
                }
              </mat-select>
            </mat-form-field>

            <!-- City -->
            <mat-form-field appearance="fill">
              <mat-label>City</mat-label>
              <mat-select formControlName="cityCtrl">
                @for (city of cities; track city.name) {
                  <mat-option [value]="city.name">{{ city.name }}</mat-option>
                }
              </mat-select>
            </mat-form-field>

            <div>
              <button mat-stroked-button matStepperPrevious>Back</button>
              <button mat-flat-button color="primary" matStepperNext [disabled]="SecondFg.invalid">
                Next
              </button>
            </div>
          </form>
        </mat-step>

        <!-- STEP 3 -->
        <mat-step>
          <ng-template matStepLabel>Confirmation</ng-template>

          <p><strong>Name:</strong> {{ UserNameCtrl.value }}</p>
          <p><strong>Email:</strong> {{ EmailCtrl.value }}</p>
          <p><strong>Country:</strong> {{ CountryCtrl.value }}</p>
          <p><strong>City:</strong> {{ CityCtrl.value }}</p>

          <div class="actions">
            <button mat-stroked-button matStepperPrevious>Back</button>
            <button mat-flat-button color="accent" (click)="register()">Register</button>
          </div>
        </mat-step>
      </mat-horizontal-stepper>

      <div class="signin-text">
        Already have an account?
        <a routerLink="/signin" class="link">Sign in here</a>
      </div>
    </div>
  </main>
</div>
